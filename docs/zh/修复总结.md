# é—®é¢˜ä¿®å¤æ€»ç»“ - Agent Group Chat æ”¶ä¸åˆ°æ¶ˆæ¯

## ğŸ” é—®é¢˜è¯Šæ–­

ä½ çš„é¡¹ç›®åœ¨è¿è¡Œåæ”¶ä¸åˆ°ä»»ä½• Agent å›å¤æ¶ˆæ¯ã€‚é€šè¿‡å¯¹æ¯” [å®˜æ–¹ç¤ºä¾‹ä»£ç ](https://github.com/microsoft/agent-framework/blob/main/dotnet/samples/GettingStarted/Workflows/_Foundational/04_AgentWorkflowPatterns/Program.cs)ï¼Œæˆ‘å‘ç°äº†ä»¥ä¸‹å…³é”®é—®é¢˜ï¼š

## âœ… å·²ä¿®å¤çš„é—®é¢˜

### 1. Triage Agent ç³»ç»Ÿæç¤ºä¸å¤Ÿæ˜ç¡®

**é—®é¢˜**: åœ¨ handoff æ¨¡å¼ä¸­ï¼Œtriage agent çš„èŒè´£æ˜¯**è·¯ç”±æ¶ˆæ¯**ï¼Œè€Œä¸æ˜¯è‡ªå·±å›å¤ã€‚ä½†æ˜¯ä½ çš„åŸå§‹æç¤ºè¯å…è®¸å®ƒåœ¨æŸäº›æƒ…å†µä¸‹è‡ªå·±å›å¤ã€‚

**å®˜æ–¹ç¤ºä¾‹çš„å…³é”®ç‚¹**:
```csharp
"You determine which agent to use based on the user's homework question. 
ALWAYS handoff to another agent."  // â† è¿™æ˜¯å…³é”®ï¼
```

**ä¿®å¤å†…å®¹**:
```csharp
// ä¿®æ”¹å‰
"If no specific agent is mentioned, respond with a friendly greeting and list available agents."

// ä¿®æ”¹å
"ALWAYS handoff to another agent. Do NOT respond yourself - only route to the appropriate agent.
If no specific agent is mentioned, handoff to Sunny."
```

### 2. æ–‡æœ¬å†…å®¹æå–é€»è¾‘ä¸å®Œæ•´

**é—®é¢˜**: åªå°è¯•ä» `AgentRunResponseUpdate.Text` è·å–æ–‡æœ¬ï¼Œä½†æŸäº›æƒ…å†µä¸‹è¿™ä¸ªå±æ€§å¯èƒ½ä¸ºç©ºï¼Œéœ€è¦ä» `Contents` é›†åˆä¸­æå– `TextContent`ã€‚

**ä¿®å¤å†…å®¹**:
```csharp
// ä¿®æ”¹å‰ - åªä½¿ç”¨ Text å±æ€§
responseText.Append(updateEvent.Update.Text);

// ä¿®æ”¹å - æœ‰å¤‡ç”¨æ–¹æ¡ˆ
var updateText = updateEvent.Update.Text;
if (!string.IsNullOrEmpty(updateText))
{
		responseText.Append(updateText);
}
else if (updateEvent.Update.Contents != null)
{
		// ä» Contents é›†åˆä¸­æå–æ–‡æœ¬
		foreach (var content in updateEvent.Update.Contents)
		{
				if (content is Microsoft.Extensions.AI.TextContent textContent)
				{
						responseText.Append(textContent.Text);
				}
		}
}
```

### 3. æ·»åŠ äº†è°ƒè¯•æ—¥å¿—

ä¸ºäº†æ–¹ä¾¿è¯Šæ–­é—®é¢˜ï¼Œæ·»åŠ äº†è¯¦ç»†çš„æ§åˆ¶å°æ—¥å¿—è¾“å‡ºï¼š

```csharp
Console.WriteLine($"[DEBUG] Event type: {evt.GetType().Name}");
Console.WriteLine($"[DEBUG] AgentRunUpdateEvent - ExecutorId: {updateEvent.ExecutorId}, Update.Text: '{updateEvent.Update.Text}'");
```

## ğŸ“ ä¿®æ”¹çš„æ–‡ä»¶

åªä¿®æ”¹äº†ä¸€ä¸ªæ–‡ä»¶ï¼š`src/AgentGroupChat/Services/AgentChatService.cs`

- **è¡Œ 100-107**: æ›´æ–°äº† triage agent çš„ç³»ç»Ÿæç¤º
- **è¡Œ 147-193**: æ”¹è¿›äº†äº‹ä»¶å¤„ç†å’Œæ–‡æœ¬æå–é€»è¾‘
- **è¡Œ 150, 154**: æ·»åŠ äº†è°ƒè¯•æ—¥å¿—

## ğŸ§ª æµ‹è¯•æ­¥éª¤

### 1. ç¡®ä¿é…ç½®æ­£ç¡®

æ£€æŸ¥ä½ çš„ `appsettings.Development.json` æ–‡ä»¶ï¼Œç¡®ä¿åŒ…å«ï¼š

```json
{
	"AzureOpenAI": {
		"Endpoint": "https://your-resource.openai.azure.com/",
		"DeploymentName": "gpt-4o-mini",
		"ApiKey": "your-api-key-here"
	}
}
```

æˆ–è€…è®¾ç½®ç¯å¢ƒå˜é‡ï¼š
```powershell
$env:AZURE_OPENAI_ENDPOINT = "https://your-resource.openai.azure.com/"
$env:AZURE_OPENAI_API_KEY = "your-api-key-here"
$env:AZURE_OPENAI_DEPLOYMENT_NAME = "gpt-4o-mini"
```

### 2. è¿è¡Œåº”ç”¨

```powershell
cd c:\github\agent-framework-tutorial-code\src\AgentGroupChat
dotnet run
```
